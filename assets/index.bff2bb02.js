import{d as H,r as s,w as N,o as J,c as G,a as f,b as n,n as k,e as S,v as B,F as D,f as F,g as K,u as Y,L as m,h as y,t as _,i as Z,j as q,W,k as X}from"./vendor.4e0958d9.js";const Q=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))v(u);new MutationObserver(u=>{for(const i of u)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&v(h)}).observe(document,{childList:!0,subtree:!0});function p(u){const i={};return u.integrity&&(i.integrity=u.integrity),u.referrerpolicy&&(i.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?i.credentials="include":u.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function v(u){if(u.ep)return;u.ep=!0;const i=p(u);fetch(u.href,i)}};Q();const ee={class:"mx-auto relative font-mono h-full"},te={class:"mx-auto p-5 bg-purple-600 bg-opacity-90 absolute top-0 left-0 right-0 z-20"},ae={class:"md:flex md:justify-between"},oe={class:"flex justify-between"},ne=n("a",{href:"#",class:"font-bold text-2xl text-white"},"Formosa",-1),ue=n("i",{class:"fas fa-search text-2xl"},null,-1),le=[ue],se=n("div",{class:"hidden md:block"},null,-1),ie={class:"hidden md:flex md:flex-row",id:"mobileMenu"},re=n("a",{href:"#"},"Youbike\u79DF\u501F",-1),de=[re],ce=n("a",{href:"#"},"\u81EA\u884C\u8ECA\u8DEF\u7DDA",-1),ve=[ce],pe=n("div",{id:"map",class:"h-screen z-0"},null,-1),he=n("i",{class:"fas fa-chevron-right text-2xl absolute top-1/3 left-0 right-0 text-white hover:text-yellow-800 animate-pulse"},null,-1),fe=[he],me={class:"flex flex-col"},ye=n("h1",{class:"text-3xl text-white font-bold my-5"},"\u8DEF\u7DDA\u67E5\u8A62",-1),ge=n("option",{value:""},"\u9078\u64C7\u7E23\u5E02",-1),xe=["value"],be=n("option",{value:""},"\u9078\u64C7\u8DEF\u7DDA",-1),we=["value"],_e=n("hr",null,null,-1),Ce={class:"my-5 overflow-y-auto h-1/2"},Ae=["onClick"],Ee={class:"text-2xl font-bold"},ke=n("i",{class:"fas fa-map-marker-alt mr-2"},null,-1),Se={class:"footer md:hidden flex justify-around items-center fixed bottom-0 bg-purple-500 w-full h-12 z-20"},De=H({setup($){const c=s([]),p=s([]),v=s([]),u=s([]),i=s([]),h=s([]),d=s(!1),O=s([{name:"\u81FA\u4E2D\u5E02",value:"Taichung"},{name:"\u57FA\u9686\u5E02",value:"Keelung"},{name:"\u65B0\u7AF9\u7E23",value:"HsinchuCounty"},{name:"\u82D7\u6817\u7E23",value:"MiaoliCounty"},{name:"\u5F70\u5316\u7E23",value:"ChanghuaCounty"},{name:"\u65B0\u5317\u5E02",value:"NewTaipei"},{name:"\u5357\u6295\u7E23",value:"NantouCounty"},{name:"\u96F2\u6797\u7E23",value:"YunlinCounty"},{name:"\u5609\u7FA9\u7E23",value:"ChiayiCounty"},{name:"\u5609\u7FA9\u5E02",value:"Chiayi"},{name:"\u5C4F\u6771\u7E23",value:"PingtungCounty"},{name:"\u5B9C\u862D\u7E23",value:"YilanCounty"},{name:"\u82B1\u84EE\u7E23",value:"HualienCounty"},{name:"\u81FA\u6771\u7E23",value:"TaitungCounty"},{name:"\u91D1\u9580\u7E23",value:"KinmenCounty"},{name:"\u6F8E\u6E56\u7E23",value:"PenghuCounty"},{name:"\u6843\u5712\u5E02",value:"Taoyuan"},{name:"\u81FA\u5317\u5E02",value:"Taipei"},{name:"\u81FA\u5357\u5E02",value:"Tainan"},{name:"\u9AD8\u96C4\u5E02",value:"Kaohsiung"}]),C=s(""),g=s([]),x=s(""),A=s("");let r=s(""),E=s(null),b=s(null);function M(){r=m.map("map").setView([0,0],15),console.log(r),r.locate({setView:!0,watch:!0}),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){const t=a.coords.longitude,e=a.coords.latitude;r.setView([e,t],15),m.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1Ijoid2VuZHl3dTAwNyIsImEiOiJja3drczVtcGIxdmhqMndtank1ZGd5enc0In0.GVbleLlq1br2y5z3vPeivw"}).addTo(r),m.marker([e,t]).addTo(r).bindPopup("<b>You are here!</b>"),j(e,t),L(e,t)},function(a){const t=a.code,e=a.message;console.error(t),console.error(e)}):r.setView([25.0320923,121.5680546],15)}function w(){let a="b0e9d82cf5c14e9cba3c9af305157476",t="gP76fsO3D7xW4VitN4ekhlwgDqU",e=new Date().toUTCString(),o=new q("SHA-1","TEXT");o.setHMACKey(t,"TEXT"),o.update("x-date: "+e);let l=o.getHMAC("B64");return{Authorization:'hmac username="'+a+'", algorithm="hmac-sha1", headers="x-date", signature="'+l+'"',"X-Date":e}}function j(a,t){fetch(`https://ptx.transportdata.tw/MOTC/v2/Bike/Station/NearBy?&format=JSON&$spatialFilter=nearby(${a},${t}, 1000)`,{headers:w()}).then(e=>e.json()).then(e=>{c.value=e})}function L(a,t){fetch(`https://ptx.transportdata.tw/MOTC/v2/Bike/Availability/NearBy?&format=JSON&$spatialFilter=nearby(${a},${t}, 1000)`,{headers:w()}).then(e=>e.json()).then(e=>{p.value=e;for(let o=0;o<p.value.length;o++)for(let l=0;l<c.value.length;l++)p.value[o].StationUID==c.value[l].StationUID&&(p.value[o].StationName=c.value[l].StationName,p.value[o].StationAddress=c.value[l].StationAddress,p.value[o].StationPosition=c.value[l].StationPosition,i.value.push(p.value[o]));T(i.value)})}function P(a){fetch(`https://ptx.transportdata.tw/MOTC/v2/Bike/Station/${a}?&format=JSON)`,{headers:w()}).then(t=>t.json()).then(t=>{v.value=t,fetch(`https://ptx.transportdata.tw/MOTC/v2/Bike/Availability/${a}?&format=JSON)`,{headers:w()}).then(e=>e.json()).then(e=>{u.value=e;for(let o=0;o<u.value.length;o++)for(let l=0;l<v.value.length;l++)u.value[o].StationUID==v.value[l].StationUID&&(u.value[o].StationName=v.value[l].StationName,u.value[o].StationAddress=v.value[l].StationAddress,u.value[o].StationPosition=v.value[l].StationPosition,h.value.push(u.value[o]));T(h.value)})})}function T(a){r.removeLayer(b),b=m.layerGroup().addTo(r);var t,e=m.icon({iconUrl:"https://yama.tw/wp-content/uploads/20190917100615_25.png",iconSize:[38,95],iconAnchor:[22,94],popupAnchor:[-3,-76],shadowSize:[68,95],shadowAnchor:[22,94]});a.forEach(o=>{t=m.marker([o.StationPosition.PositionLat,o.StationPosition.PositionLon],{icon:e}).addTo(b),t.bindPopup(`
					<b class="text-gray-500">YouBike 1.0</b><br>
					<b class="text-xl">${o.StationName.Zh_tw}</b><br>
					<b>\u5730\u9EDE:${o.StationAddress.Zh_tw}</b><br>
					<div class="flex justify-between my-2">
						<span class="bg-yellow-500 py-1 px-4 rounded-lg"><b class="text-white font-bold text-lg">\u53EF\u501F ${o.AvailableRentBikes}</b></span>
						<span class="bg-yellow-400 py-1 px-4 rounded-lg"><b class="text-white font-bold text-lg">\u53EF\u505C ${o.AvailableReturnBikes}</b></span>
					</div>
					<b class="mt-2 text-gray-500">\u66F4\u65B0\u6642\u9593 : ${o.UpdateTime.split("T")[0]} ${o.UpdateTime.split("T")[1].split("+")[0]}</b>
				`),b.addLayer(t)}),r.addLayer(b)}function z(a){v.value=[],u.value=[],h.value=[],fetch(`https://ptx.transportdata.tw/MOTC/v2/Cycling/Shape/${a}?&format=JSON`,{headers:w()}).then(t=>t.json()).then(t=>{g.value=t,P(a)})}function V(a){g.value.forEach(t=>{if(t.RouteName===a){var e=t.Geometry;I(e)}})}function I(a){r.removeLayer(E);const e=new W.Wkt().read(a).toJson(),o={color:"#ff0000",weight:5,opacity:.65};E=m.geoJSON(e,{style:o}).addTo(r),E.addData(e),r.fitBounds(E.getBounds())}function R(a){x.value=a}N(C,(a,t)=>{a!==""&&z(C.value)}),N(x,(a,t)=>{a!==""&&V(x.value)}),J(()=>{M()});const U=G(()=>A.value!==""?g.value.filter(a=>a.RouteName.match(A.value)):g.value);return(a,t)=>(y(),f("div",ee,[n("div",te,[n("nav",ae,[n("div",oe,[ne,n("p",{id:"hamburgerbtn",class:"md:hidden text-white",onClick:t[0]||(t[0]=e=>d.value=!d.value)},le)]),se,n("ul",ie,[n("li",{class:k(["pr-5 text-white text-2xl font-bold",{underline:!d.value}]),onClick:t[1]||(t[1]=e=>d.value=!1)},de,2),n("li",{class:k(["pr-5 text-white text-2xl font-bold",{underline:d.value}]),onClick:t[2]||(t[2]=e=>d.value=!0)},ve,2)])])]),pe,n("div",{class:k(["bg-purple-300 z-10 h-full w-80 absolute top-2 left-0 transition-all duration-300 mt-16",{"-ml-80":!d.value}])},[n("div",{class:"absolute top-1/3 -right-10 transform -translate-y-1/2 bg-yellow-500 h-20 w-10 rounded-tr-lg rounded-br-lg",onClick:t[3]||(t[3]=e=>d.value=!d.value)},fe),n("div",me,[ye,S(n("select",{name:"",id:"","onUpdate:modelValue":t[4]||(t[4]=e=>C.value=e),class:"rounded-full py-2 px-4 my-2 w-10/12 mx-auto"},[ge,(y(!0),f(D,null,F(O.value,e=>(y(),f("option",{value:e.value,key:e.value},_(e.name),9,xe))),128))],512),[[B,C.value]]),S(n("select",{name:"",id:"",class:"w-10/12 rounded-full py-2 px-4 my-2 mx-auto","onUpdate:modelValue":t[5]||(t[5]=e=>x.value=e)},[be,(y(!0),f(D,null,F(g.value,e=>(y(),f("option",{value:e.RouteName,key:e.AuthorityName},_(e.RouteName),9,we))),128))],512),[[B,x.value]]),S(n("input",{type:"text",placeholder:"\u8ACB\u8F38\u5165\u8DEF\u7DDA\u95DC\u9375\u5B57",class:"rounded-full py-2 px-4 my-2 w-10/12 mx-auto","onUpdate:modelValue":t[6]||(t[6]=e=>A.value=e)},null,512),[[K,A.value]])]),_e,n("div",Ce,[(y(!0),f(D,null,F(Y(U),e=>(y(),f("div",{key:e.RouteName,class:"bg-white w-10/12 mx-auto my-2 rounded-lg p-3 text-left",onClick:o=>R(e.RouteName)},[n("h1",Ee,_(e.RouteName),1),n("p",null,"\u5168\u9577: "+_(e.CyclingLength)+" \u516C\u91CC",1),n("b",null,[ke,Z(_(e.City),1)])],8,Ae))),128))])],2),n("div",Se,[n("span",{class:"text-white font-bold text-xl",onClick:t[7]||(t[7]=e=>d.value=!1)},"Youbike\u79DF\u501F"),n("span",{class:"text-white font-bold text-xl",onClick:t[8]||(t[8]=e=>d.value=!0)},"\u81EA\u884C\u8ECA\u8DEF\u7DDA")])]))}});X(De).mount("#app");
